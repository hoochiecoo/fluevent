plugins {
    id "com.android.application"
    id "org.jetbrains.kotlin.android"
    id "dev.flutter.flutter-gradle-plugin"
}
android {
    namespace "com.example.camera_starter"
    compileSdkVersion 34
    ndkVersion flutter.ndkVersion
    compileOptions {
        sourceCompatibility JavaVersion.VERSION_1_8
        targetCompatibility JavaVersion.VERSION_1_8
    }
    kotlinOptions { jvmTarget = '1.8' }
    sourceSets {
        main {
            java {
                srcDirs += 'src/main/kotlin'
                def opencvSrc = file('../../opencv/sdk/java/src')
                if (opencvSrc.exists()) {
                    println "Including OpenCV core-only Java sources from: ${opencvSrc}"
                    srcDirs += opencvSrc.toString()
                    // Only include minimal packages required for Mat/Imgproc/OpenCVLoader/Utils
                    include 'org/opencv/core/**'
                    include 'org/opencv/imgproc/**'
                    include 'org/opencv/utils/**'
                    include 'org/opencv/android/OpenCVLoader.java'
                    include 'org/opencv/android/Utils.java'
                    // Exclude everything else (not strictly necessary when includes used, but keep safe)
                    exclude 'org/opencv/android/Camera**'
                    exclude 'org/opencv/android/JavaCamera**'
                    exclude 'org/opencv/android/NativeCamera**'
                    exclude 'org/opencv/calib3d/**'
                    exclude 'org/opencv/features2d/**'
                    exclude 'org/opencv/objdetect/**'
                    exclude 'org/opencv/video/**'
                    exclude 'org/opencv/videoio/**'
                    exclude 'org/opencv/photo/**'
                }
            }
        }
    }
    defaultConfig {
        applicationId "com.example.camera_starter"
        minSdkVersion 24
        targetSdkVersion 34
        versionCode 1
        versionName "1.0"
    }
    packagingOptions {
        pickFirst 'lib/*/libc++_shared.so'
        pickFirst 'lib/*/libopencv_java4.so'
    }
}
dependencies {
   implementation "androidx.camera:camera-core:1.3.0"
   implementation "androidx.camera:camera-camera2:1.3.0"
   implementation "androidx.camera:camera-lifecycle:1.3.0"
   implementation "androidx.camera:camera-view:1.3.0"
   implementation 'androidx.concurrent:concurrent-futures-ktx:1.1.0'

}
